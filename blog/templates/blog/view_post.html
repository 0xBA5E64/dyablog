{% extends "./base.html" %}

{% block title %}
{{ post.title }} - Dyablog.
{% endblock %}

{% block content %}
<div class="post">
    <div class="post-header">
        <h2 class="author">
            {% if post.author.first_name %}
            {{ post.author.first_name }} {{post.author.last_name}}
            {% else %}
            {{ post.author.username }}
            {% endif %}
        </h2>
        <h1 class="title">{{ post.title }}</h1>
        <h3 class="pub-date">Published on: <span>{{post.pub_date.date}}</span></h3>
        {% if perms.blog.change_blogpost %}
        <a class="edit" href="edit">Edit Post</a>
        {% endif %}
    </div>
    <div class="prose m-4 w-full">
        {% load editorjs %}
        {{ post.body|editorjs}}
    </div>
    <div class="post-comments">
        <h2>Comments:</h2>
        {% if perms.blog.add_commentpost %}
        <form method="post">
            {% csrf_token %}
            <textarea name="body" cols="40" rows="5" maxlength="800"></textarea>
            <button>Submit Comment</button>
        </form>
        {% endif %}
        {% if post.comments.all %}
        {% for comment in post.comments.all %}
        <div class="comment">
            <p class="author">
                {% if comment.author.first_name %}
                {{comment.author.first_name}} {{comment.author.last_name}}
                {% else %}
                <span class="username">{{comment.author.username}}</span>
                {% endif %}
                <span class="time-date">{{comment.timestamp}}</span>
            </p>
            <p>{{comment.body}}</p>
        </div>
        {% endfor %}
        {% else %}
        <p>This post does not yet have any comments.</p>
        {% endif %}
    </div>
</div>
{% endblock %}
